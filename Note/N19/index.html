<!DOCTYPE html>
<html lang="ko">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Download</title>
        <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
            rel="stylesheet"
            integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
            crossorigin="anonymous"
        />
        <style>
            body {
                background-color: #121212;
                color: #e0e0e0;
            }
            .accordion-button {
                background-color: #1e1e1e;
                color: #e0e0e0;
            }
            .accordion-button:not(.collapsed) {
                color: #e0e0e0;
                background-color: #333;
            }
            .accordion-body {
                background-color: #1e1e1e;
            }
            .list-group-item {
                background-color: #1e1e1e;
                color: #e0e0e0;
                border: 1px solid #333;
            }
            a {
                color: #1e90ff;
                text-decoration: none;
            }
            a:hover {
                color: #63a4ff;
            }
            .input-group {
                margin-top: 20px;
            }
            .btn-outline-primary {
                color: #1e90ff;
                border-color: #1e90ff;
            }
            .btn-outline-primary:hover {
                background-color: #1e90ff;
                color: #fff;
            }
            .modal-content {
                background-color: #1e1e1e;
                color: #e0e0e0;
            }
            .btn-close {
                filter: invert(1);
            }
        </style>
    </head>
    <body>
        <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h1 class="modal-title fs-5" id="exampleModalLabel">파일전송완료</h1>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">파일이 정상적으로 전송되었습니다!</div>
                    <div class="modal-footer">
                        <button
                            type="button"
                            class="btn btn-secondary"
                            data-bs-dismiss="modal"
                            onclick="window.location.href='/'"
                        >
                            Close
                        </button>
                    </div>
                </div>
            </div>
        </div>
        <div class="accordion" id="accordionExample">
            <div class="accordion-item">
                <h2 class="accordion-header">
                    <button
                        class="accordion-button"
                        type="button"
                        data-bs-toggle="collapse"
                        data-bs-target="#collapseOne"
                        aria-expanded="true"
                        aria-controls="collapseOne"
                    >
                        Download
                    </button>
                </h2>
                <div id="collapseOne" class="accordion-collapse collapse show" data-bs-parent="#accordionExample">
                    <div class="accordion-body">
                        <div class="list-group" id="file-list">
                            <!-- 파일 목록이 여기에 삽입됩니다 -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="input-group">
            <form action="/up" method="POST" enctype="multipart/form-data" class="input-group mb-3">
                <input type="file" class="form-control" id="inputGroupFile02" name="ufile" />
                <button
                    class="btn btn-outline-primary"
                    data-bs-toggle="modal"
                    data-bs-target="#exampleModal"
                    type="submit"
                    id="inputGroupFileAddon04"
                >
                    파일업로드
                </button>
            </form>
        </div>
        <script
            src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
            crossorigin="anonymous"
        ></script>
        <script>
            document.addEventListener('DOMContentLoaded', function () {
                fetch('/files')
                    .then((response) => response.json())
                    .then((files) => {
                        const fileList = document.getElementById('file-list');
                        files.forEach((file) => {
                            const listItem = document.createElement('li');
                            listItem.className = 'list-group-item';
                            listItem.innerHTML = `<a href='/list/${file}' class="file-link">${file}</a><a href='/list/${file}' class="file-link" download> - [Download]</a>`;
                            fileList.appendChild(listItem);
                        });
                    });
            });
        </script>
    </body>
</html>
